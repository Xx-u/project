{"version":3,"file":"js/977.61ee7b6d.js","mappings":"2aA0EA,IAAIA,GAASC,EAAAA,EAAAA,MACTC,GAAQC,EAAAA,EAAAA,MACRC,GAAcC,EAAAA,EAAAA,IAAS,CAAEC,WAAY,MACrCC,GAAYC,EAAAA,EAAAA,IAAI,IAChBC,GAASD,EAAAA,EAAAA,IAAI,IAKjBE,eAAeC,IACb,IAAIC,QAAYC,EAAAA,EAAAA,IAAI,gBAAiBT,GACrCQ,EAAIE,OAAOC,SAAQC,IACjBA,EAAIC,SAAU,CAAd,IAEFV,EAAUW,MAAQN,EAAIE,OACtBL,EAAOS,MAAQ,OAASX,EAAUW,MAAMC,OAAS,GAClD,EAVDC,EAAAA,EAAAA,MACAT,IAWA,MAAMU,EAAW,CAACC,EAAIC,MACpBC,EAAAA,EAAAA,IAAK,iBAAgBF,IAAM,CAAE,IAAOC,IAAOE,MAAKb,IAC9Cc,QAAQC,IAAIf,EAAZ,GADF,EAKIgB,GAAWC,EAAAA,EAAAA,IAAS,CACxBhB,MACE,IAAIiB,GAAO,EAIX,OAHIvB,EAAUW,MAAMC,SAClBW,EAAOvB,EAAUW,MAAMa,OAAMf,GAAOA,EAAIC,WAEnCa,CACR,EACDE,IAAKC,IACHb,EAAAA,EAAAA,MACAb,EAAUW,MAAMH,SAAQC,IACtBA,EAAIC,QAAUgB,CAAd,GAEH,IAGGC,GAAWL,EAAAA,EAAAA,KAAS,MACxBT,EAAAA,EAAAA,MACA,IAAIe,EAAQ,EAMZ,OALA5B,EAAUW,MAAMH,SAAQC,IAClBA,EAAIC,UACNkB,GAASnB,EAAIoB,OAAOC,MAAQrB,EAAIO,IAAM,IACvC,IAEIY,CAAP,IAIIG,EAAahB,IACjBpB,EAAMqC,OAAO,mBAAoB,QACjCvC,EAAOwC,KAAM,iBAAgBlB,IAA7B,EAIImB,EAAc,MAClBrB,EAAAA,EAAAA,MACAlB,EAAMqC,OAAO,mBAAoB,QACjCG,QAAQC,MAAR,EAGIC,EAAelC,UACnB,IAAImC,EAAItC,EAAUW,MAAM4B,QAAO9B,GAAOA,EAAIC,UAASE,OAC9C0B,EAGHE,EAAAA,EAAAA,QAAe,CACbC,MAAO,QACPC,MAAO,eACPC,QACE,UAEDzB,MAAK,KACJlB,EAAUW,MAAMiC,KAAIzC,UAClB,GAAIM,EAAIC,QAAS,OACCmC,EAAAA,EAAAA,IAAK,iBAAgBpC,EAAIM,OACzCF,EAAAA,EAAAA,IAAM,SACNT,GACD,IALH,IAOC0C,OAAM,UAhBXC,EAAAA,EAAAA,GAAM,QAiBP,EAGGC,EAAYjC,IAChByB,EAAAA,EAAAA,QAAe,CACbC,MAAO,QACPE,QACE,UAEDzB,MAAK,MACJ2B,EAAAA,EAAAA,IAAK,iBAAgB9B,KAAMG,MAAKb,KAC9BQ,EAAAA,EAAAA,IAAM,SACNT,GAAM,GAFR,IAIC0C,OAAM,QAVX,EAaIG,EAAgB,KACpB,IAAIC,EAAS,GACTC,EAAMnD,EAAUW,MAAM4B,QAAO9B,GAAOA,EAAIC,UAC5Cf,EAAMyD,MAAMC,UAAUC,SAAWH,EACjCA,EAAI3C,SAAQC,IACVyC,EAAOjB,KAAKxB,EAAIM,GAAhB,IAEEoC,EAAIvC,SACNC,EAAAA,EAAAA,MACApB,EAAOwC,KAAK,gBAEZc,EAAAA,EAAAA,GAAM,QACP,E,ytDCrLH,MAAMQ,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://demo/./src/views/shopping/Shopping.vue","webpack://demo/./src/views/shopping/Shopping.vue?85c2"],"sourcesContent":["<template>\r\n  <div class=\"body\">\r\n    <div class=\"page\">\r\n      <div class=\"top\">\r\n        <van-nav-bar\r\n          :title=\"lenght\"\r\n          left-arrow\r\n          @click-left=\"onClickLeft\"\r\n          right-text=\"删除\"\r\n          @click-right=\"onClickRight\"\r\n        />\r\n      </div>\r\n      <div class=\"main\">\r\n        <div class=\"card\" v-for=\"item in goodsList\" :key=\"item.id\">\r\n          <van-swipe-cell>\r\n            <van-card\r\n              :price=\"item.s_good.price\"\r\n              :desc=\"item.s_good.desc\"\r\n              :title=\"item.s_good.name\"\r\n              :thumb=\"item.s_good.s_goods_photos[0].path\"\r\n              @click-thumb=\"checkCard(item.s_good.id)\"\r\n            >\r\n              <template #tags>\r\n                <van-tag plain type=\"danger\">新款</van-tag>\r\n                <van-tag plain type=\"danger\">上新</van-tag>\r\n              </template>\r\n              <template #footer>\r\n                <van-stepper\r\n                  v-model=\"item.num\"\r\n                  @change=\"checkNum(item.id, item.num)\"\r\n                />\r\n              </template>\r\n            </van-card>\r\n            <template #right>\r\n              <van-button\r\n                square\r\n                text=\"删除\"\r\n                type=\"danger\"\r\n                class=\"delete-button\"\r\n                @click=\"delClick(item.id)\"\r\n              />\r\n            </template>\r\n          </van-swipe-cell>\r\n\r\n          <div class=\"checked\">\r\n            <van-checkbox\r\n              v-model=\"item.checked\"\r\n              checked-color=\"#ee0a24\"\r\n            ></van-checkbox>\r\n          </div>\r\n        </div>\r\n        <div class=\"submit\">\r\n          <van-submit-bar\r\n            :price=\"sumPrice\"\r\n            button-text=\"结算\"\r\n            @submit=\"goToOrderpage\"\r\n          >\r\n            <van-checkbox v-model=\"checkAll\" checked-color=\"#ee0a24\"\r\n              >全选</van-checkbox\r\n            >\r\n          </van-submit-bar>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { Toast, Dialog } from 'vant';\r\nimport { toast } from '../../Utils/index.js'\r\nimport { get, del, put } from '../../Utils/request.js'\r\nimport { reactive, ref, computed } from 'vue';\r\nimport { useRouter } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nlet router = useRouter()\r\nlet store = useStore()\r\nlet goodsParams = reactive({ project_id: 240 })\r\nlet goodsList = ref([])\r\nlet lenght = ref('')\r\n\r\ntoast()\r\ncard()\r\n// 请求goods\r\nasync function card () {\r\n  let res = await get('/shoppingCart', goodsParams)\r\n  res.result.forEach(ele => {\r\n    ele.checked = true\r\n  })\r\n  goodsList.value = res.result\r\n  lenght.value = '购物车(' + goodsList.value.length + ')'\r\n}\r\n// 更新num\r\nconst checkNum = (id, num) => {\r\n  put(`/shoppingCart/${id}`, { \"num\": num }).then(res => {\r\n    console.log(res);\r\n  })\r\n}\r\n// 全选\r\nconst checkAll = computed({\r\n  get () {\r\n    let flag = false\r\n    if (goodsList.value.length) {\r\n      flag = goodsList.value.every(ele => ele.checked)\r\n    }\r\n    return flag\r\n  },\r\n  set (val) {\r\n    toast()\r\n    goodsList.value.forEach(ele => {\r\n      ele.checked = val\r\n    })\r\n  }\r\n})\r\n// 总额\r\nconst sumPrice = computed(() => {\r\n  toast()\r\n  let money = 0\r\n  goodsList.value.forEach(ele => {\r\n    if (ele.checked) {\r\n      money += ele.s_good.price * ele.num * 100\r\n    }\r\n  })\r\n  return money\r\n})\r\n\r\n// 点击进入商品详情\r\nconst checkCard = (id) => {\r\n  store.commit(\"changeRouterType\", \"push\")\r\n  router.push(`/shoppage?key=${id}`)\r\n}\r\n\r\n// 返回\r\nconst onClickLeft = () => {\r\n  toast()\r\n  store.commit(\"changeRouterType\", \"back\")\r\n  history.back()\r\n}\r\n// 删除选中\r\nconst onClickRight = async () => {\r\n  let a = goodsList.value.filter(ele => ele.checked).length\r\n  if (!a) {\r\n    Toast('请选择商品');\r\n  } else {\r\n    Dialog.confirm({\r\n      title: '小xu提示',\r\n      theme: 'round-button',\r\n      message:\r\n        '是否删除?',\r\n    })\r\n      .then(() => {\r\n        goodsList.value.map(async ele => {\r\n          if (ele.checked) {\r\n            let res = await del(`/shoppingCart/${ele.id}`)\r\n            toast('删除成功!')\r\n            card()\r\n          }\r\n        })\r\n      }).catch(() => { });\r\n  }\r\n}\r\n// 单个删除\r\nconst delClick = (id) => {\r\n  Dialog.confirm({\r\n    title: '小xu提示',\r\n    message:\r\n      '是否删除?',\r\n  })\r\n    .then(() => {\r\n      del(`/shoppingCart/${id}`).then(res => {\r\n        toast('删除成功!')\r\n        card()\r\n      })\r\n    }).catch(() => { });\r\n}\r\n// 结算\r\nconst goToOrderpage = () => {\r\n  let idList = []\r\n  let arr = goodsList.value.filter(ele => ele.checked)\r\n  store.state.shoporder.cradList = arr\r\n  arr.forEach(ele => {\r\n    idList.push(ele.id)\r\n  })\r\n  if (arr.length) {\r\n    toast()\r\n    router.push('/orderpage')\r\n  } else {\r\n    Toast('请选择商品');\r\n  }\r\n}\r\n\r\n\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.body {\r\n  width: 100%;\r\n  min-height: calc(100vh - 1rem);\r\n  background-color: #f6f6f6;\r\n  .page {\r\n    padding-top: 0.16rem;\r\n    margin-top: 000.46rem;\r\n    margin-left: 00.16rem;\r\n    margin-right: 00.16rem;\r\n  }\r\n}\r\n.main {\r\n  padding-bottom: 1rem;\r\n}\r\n.top {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  z-index: 99;\r\n  width: 100%;\r\n}\r\n\r\n.card {\r\n  position: relative;\r\n  margin-bottom: 00.2rem;\r\n  border-radius: 0.15rem;\r\n  box-shadow: rgb(0 0 0 / 25%) 0rem 0.05rem 0.15rem;\r\n  .van-card {\r\n    border-radius: 00.15rem;\r\n    // margin-left: 00.1rem;\r\n    background-color: #fff;\r\n  }\r\n  .delete-button {\r\n    height: 100%;\r\n  }\r\n  .checked {\r\n    position: absolute;\r\n    left: -2%;\r\n    top: 3%;\r\n    transform: translate(0, -50%);\r\n  }\r\n}\r\n.submit {\r\n  .van-submit-bar {\r\n    bottom: 00.5rem !important;\r\n  }\r\n}\r\n</style>","import script from \"./Shopping.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Shopping.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Shopping.vue?vue&type=style&index=0&id=d54163e0&lang=scss&scoped=true\"\n\nimport exportComponent from \"F:\\\\My-project\\\\shop\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d54163e0\"]])\n\nexport default __exports__"],"names":["router","useRouter","store","useStore","goodsParams","reactive","project_id","goodsList","ref","lenght","async","card","res","get","result","forEach","ele","checked","value","length","toast","checkNum","id","num","put","then","console","log","checkAll","computed","flag","every","set","val","sumPrice","money","s_good","price","checkCard","commit","push","onClickLeft","history","back","onClickRight","a","filter","Dialog","title","theme","message","map","del","catch","Toast","delClick","goToOrderpage","idList","arr","state","shoporder","cradList","__exports__"],"sourceRoot":""}