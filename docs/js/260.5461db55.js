"use strict";(self["webpackChunkdemo"]=self["webpackChunkdemo"]||[]).push([[260],{4260:function(e,a,l){l.r(a),l.d(a,{default:function(){return A}});var s=l(3396),t=l(7139),o=l(4870),u=l(6431),n=l(6329),d=l(5743),i=l(65),c=l(2483);const p=e=>((0,s.dD)("data-v-257ec971"),e=e(),(0,s.Cn)(),e),r={class:"body"},v={class:"orderpage"},m={class:"top"},h={class:"address"},_={class:"edit"},g=p((()=>(0,s._)("h3",null,"收货地址",-1))),f={class:"actionsheet"},b={class:"content"},w={class:"order"},W={class:"count"},k={class:"money"},U={class:"goodsMoney"},y={class:"center"},S={class:"all"},H={class:"submit"};var C={__name:"orderPage",setup(e){(0,c.yj)();let a=(0,c.tv)(),l=(0,i.oR)(),p=(0,o.iH)([]),C=(0,o.iH)([]),D=(0,o.iH)(null),x=(0,o.iH)(!1),A=(0,o.iH)(""),E=(0,o.iH)(l.state.shoporder.cradList);async function R(){p.value=[];let e=await(0,d.U2)("/address");e.result.forEach((e=>{let a={id:e.id,name:e.name,tel:e.phone,address:e.area_name+"  "+e.desc,isDefault:"1"===e.default_set};p.value.push(a)})),C.value=p.value.find((e=>e.isDefault)),A.value=C.value.id,D.value="默认"}R();const T=e=>{C.value=e,x.value=!1,C.value.isDefault?D.value="默认":D.value=""},V=()=>{x.value=!0},z=()=>{(0,n.Am)(),l.commit("changeRouterType","push"),a.push("/newedit")},L=e=>{(0,n.Am)(),l.commit("changeRouterType","push"),a.push(`/edit?key=${e.id}`)},j=(0,s.Fl)((()=>{let e=0;return E.value.forEach((a=>{e+=a.s_good.price*a.num*100})),e})),q=(0,s.Fl)((()=>{let e=0;return E.value.forEach((a=>{e+=a.num})),e})),F={available:1,condition:"无门槛\n最多优惠12元",reason:"",value:150,name:"优惠券名称",startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"元"},I=(0,o.iH)([F]),$=(0,o.iH)(!1),K=(0,o.iH)(-1),M=e=>{$.value=!1,K.value=e},O=e=>{I.value.push(F)},P=()=>{u.V.confirm({title:"小xu提示",message:"您是否确认取消订单?"}).then((()=>{l.commit("changeRouterType","back"),a.push("/shopping")})).catch((()=>{}))},Y=async()=>{(0,n.Am)();let e=l.state.shoporder.cradList,s=C.value,t=[],o=[];e.forEach((e=>{let a={id:e.goods_id,num:e.num};o.push(a),t.push(e.goods_id)}));let u={addr_id:s.id,goods_info:o,project_id:240,shoppingCartIds:t};(0,d.v_)("/order",u).then((e=>{let s=e.data.result.id;l.commit("changeRouterType","push"),a.push(`/paymentOrder?key=${s}`)}))};return(e,a)=>{const l=(0,s.up)("van-nav-bar"),u=(0,s.up)("van-badge"),n=(0,s.up)("van-icon"),d=(0,s.up)("van-address-list"),i=(0,s.up)("van-action-sheet"),c=(0,s.up)("van-card"),R=(0,s.up)("van-swipe-cell"),F=(0,s.up)("van-cell"),Z=(0,s.up)("van-coupon-cell"),B=(0,s.up)("van-coupon-list"),G=(0,s.up)("van-popup"),J=(0,s.up)("van-submit-bar");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",v,[(0,s._)("div",m,[(0,s.Wm)(l,{title:"确认订单","left-text":"","left-arrow":"",onClickLeft:P})]),(0,s._)("div",h,[(0,s._)("div",_,[g,(0,s._)("p",null,[(0,s.Uk)((0,t.zw)((0,o.SU)(C).address)+" ",1),(0,s.Wm)(u,{class:"badge",content:(0,o.SU)(D)},null,8,["content"])]),(0,s._)("p",null,[(0,s.Uk)((0,t.zw)((0,o.SU)(C).name)+" ",1),(0,s._)("span",null,(0,t.zw)((0,o.SU)(C).tel),1)])]),(0,s.Wm)(n,{class:"edit-icon",name:"edit",onClick:V})]),(0,s._)("div",f,[(0,s.Wm)(i,{show:(0,o.SU)(x),"onUpdate:show":a[1]||(a[1]=e=>(0,o.dq)(x)?x.value=e:x=e),title:"选择收货地址"},{default:(0,s.w5)((()=>[(0,s._)("div",b,[(0,s.Wm)(d,{modelValue:(0,o.SU)(A),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,o.dq)(A)?A.value=e:A=e),list:(0,o.SU)(p),"default-tag-text":"默认",onSelect:T,switchable:"",onAdd:z,onEdit:L},null,8,["modelValue","list"])])])),_:1},8,["show"])]),(0,s._)("div",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)((0,o.SU)(E),(e=>((0,s.wg)(),(0,s.iD)("div",{class:"goods",key:e.id},[(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{num:e.num,price:e.s_good.price,desc:e.s_good.desc,title:e.s_good.name,class:"goods-card",thumb:e.s_good.s_goods_photos[0].path},null,8,["num","price","desc","title","thumb"])])),_:2},1024)])))),128)),(0,s._)("div",W,[(0,s.Wm)(R,null,{default:(0,s.w5)((()=>[(0,s.Wm)(F,{border:!1,title:"配送服务",value:"快递 包邮","is-link":""}),(0,s.Wm)(F,{border:!1,title:"运费险",value:"未选择","is-link":""}),(0,s.Wm)(F,{border:!1,title:"订单备注",value:"无备注","is-link":""})])),_:1})])]),(0,s._)("div",k,[(0,s._)("div",U,[(0,s.Wm)(F,{value:"价格明细"}),(0,s.Wm)(F,{title:"商品总数",value:(0,o.SU)(q)},null,8,["value"])]),(0,s._)("div",y,[(0,s.Wm)(Z,{coupons:I.value,"chosen-coupon":K.value,onClick:a[2]||(a[2]=e=>$.value=!0)},null,8,["coupons","chosen-coupon"]),(0,s.Wm)(G,{show:$.value,round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(B,{coupons:I.value,"chosen-coupon":K.value,"disabled-coupons":e.disabledCoupons,onChange:M,onExchange:O},null,8,["coupons","chosen-coupon","disabled-coupons"])])),_:1},8,["show"])]),(0,s._)("div",S,[(0,s.Wm)(F,{title:"合计",value:"￥"+(0,o.SU)(j)/100},null,8,["value"])])]),(0,s._)("div",H,[(0,s.Wm)(J,{price:(0,o.SU)(j),"button-text":"提交订单",onSubmit:Y},null,8,["price"])])])])}}},D=l(89);const x=(0,D.Z)(C,[["__scopeId","data-v-257ec971"]]);var A=x}}]);
//# sourceMappingURL=260.5461db55.js.map