{"version":3,"file":"js/125.d12dfefa.js","mappings":"stBAiFA,MAAMA,GAAQC,EAAAA,EAAAA,MACRC,GAASC,EAAAA,EAAAA,MACf,IAAIC,GAAYC,EAAAA,EAAAA,IAAI,IAChBC,GAAUD,EAAAA,EAAAA,KAAIE,EAAAA,EAAAA,IAAW,cACzBC,GAAOH,EAAAA,EAAAA,KAAI,GACXI,GAAOJ,EAAAA,EAAAA,KAAI,GACXK,GAAWL,EAAAA,EAAAA,IAAI,IACfM,GAAYN,EAAAA,EAAAA,IAAI,IAChBO,GAAYP,EAAAA,EAAAA,KAAI,IAEpBQ,EAAAA,EAAAA,IAAI,0BAA2B,CAAEC,WAAY,MAAOC,MAAKC,IACvDN,EAASO,MAAQD,EAAIE,MAArB,IAEF,MAAMC,EAAYC,IAChBhB,EAAUa,MAAQG,GAClBP,EAAAA,EAAAA,IAAI,eAAgB,CAAEC,WAAY,IAAKO,KAAMD,IAAOL,MAAKC,IACvDM,QAAQC,IAAIP,GACPA,EAAIE,OAAOM,KAAKC,OAMnBb,EAAUK,OAAQ,GALlBL,EAAUK,OAAQ,GAClBJ,EAAAA,EAAAA,IAAI,SAAU,CAAEC,WAAY,IAAKY,KAAM,EAAGC,MAAO,KAAMZ,MAAKC,IAC1DL,EAAUM,MAAQD,EAAIE,OAAOM,IAA7B,KAKJb,EAAUM,MAAQD,EAAIE,OAAOM,IAA7B,GAVF,EAeII,EAAYR,KAChBS,EAAAA,EAAAA,MACArB,EAAKS,OAAQ,EACbR,EAAKQ,OAAQ,EACTG,GACFpB,EAAM8B,SAAS,sBAAuBV,GAExCD,EAASC,EAAT,EAGIW,EAAS,MACbF,EAAAA,EAAAA,MACArB,EAAKS,OAAQ,EACbR,EAAKQ,OAAQ,EACTb,EAAUa,OACZjB,EAAM8B,SAAS,sBAAuB1B,EAAUa,OAElDE,EAASf,EAAUa,MAAnB,EAGIe,EAAgBC,KACpBJ,EAAAA,EAAAA,MACArB,EAAKS,OAAQ,EACbR,EAAKQ,OAAQ,EACbE,EAASc,EAAT,EAGIC,EAAa,MACjBL,EAAAA,EAAAA,MACA7B,EAAM8B,SAAS,kBACfxB,EAAQW,OAAQV,EAAAA,EAAAA,IAAW,YAA3B,EAII4B,EAAY,CAACC,EAAIhB,KACrBhB,EAAUa,MAAQG,GAClBS,EAAAA,EAAAA,MACArB,EAAKS,OAAQ,EACbR,EAAKQ,OAAQ,EACTG,GACFpB,EAAM8B,SAAS,sBAAuBV,IAExCP,EAAAA,EAAAA,IAAI,SAAU,CAAEC,WAAY,IAAKY,KAAM,EAAGC,MAAO,GAAIU,YAAaD,IAAMrB,MAAKC,IACtEA,EAAIE,OAAOM,KAAKC,SACnBb,EAAUK,OAASL,EAAUK,OAC7BJ,EAAAA,EAAAA,IAAI,SAAU,CAAEC,WAAY,IAAKY,KAAM,EAAGC,MAAO,KAAMZ,MAAKC,IAC1DL,EAAUM,MAAQD,EAAIE,OAAOM,IAA7B,KAGJb,EAAUM,MAAQD,EAAIE,OAAOM,IAA7B,GAPF,EAaIc,EAAW,MACfT,EAAAA,EAAAA,MACA7B,EAAMuC,OAAO,mBAAoB,QACjCC,QAAQC,MAAR,EAGIC,EAAcN,IAClBpC,EAAMuC,OAAO,mBAAoB,QACjCrC,EAAOyC,KAAM,gBAAeP,IAA5B,E,4wDCxKF,MAAMQ,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://demo/./src/views/search/Searchpage.vue","webpack://demo/./src/views/search/Searchpage.vue?e7aa"],"sourcesContent":["<template>\r\n  <div class=\"body\">\r\n    <div class=\"page\">\r\n      <div class=\"top\">\r\n        <div class=\"left\" @click=\"onCancel\">\r\n          <van-icon name=\"arrow-left\" />\r\n        </div>\r\n        <div class=\"input\">\r\n          <form action=\"/\">\r\n            <van-search\r\n              v-model=\"searchVal\"\r\n              shape=\"round\"\r\n              placeholder=\"请输入搜索关键词\"\r\n              @search=\"onSearch\"\r\n              :clearable=\"true\"\r\n            />\r\n          </form>\r\n        </div>\r\n        <div class=\"right\" @click=\"search\">\r\n          <span>搜索</span>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"oldSearch search\" v-show=\"show\">\r\n        <div class=\"title\">\r\n          <h2>历史搜索</h2>\r\n          <van-icon @click=\"deloldlist\" name=\"delete-o\" />\r\n        </div>\r\n        <van-button\r\n          v-for=\"(item, index) in oldlist\"\r\n          :key=\"index\"\r\n          type=\"default\"\r\n          size=\"small\"\r\n          @click=\"checkoldlist(item)\"\r\n          >{{ item }}</van-button\r\n        >\r\n      </div>\r\n      <div class=\"listSearch search\" v-show=\"show\">\r\n        <h2>热门搜索</h2>\r\n        <van-button\r\n          v-for=\"(item, index) in shopList\"\r\n          :key=\"index\"\r\n          type=\"default\"\r\n          size=\"small\"\r\n          @click=\"checklist(item.id, item.name)\"\r\n          >{{ item.name }}</van-button\r\n        >\r\n      </div>\r\n\r\n      <div class=\"empty\" v-show=\"emptyShow\">\r\n        <van-empty image=\"search\" description=\"暂无搜索商品\" />\r\n        <h3>推荐商品</h3>\r\n      </div>\r\n\r\n      <div class=\"goodslist\" v-show=\"flag\">\r\n        <div v-for=\"item in goodslist\" :key=\"item.id\">\r\n          <van-card\r\n            :price=\"item.price\"\r\n            :desc=\"item.desc\"\r\n            :title=\"item.name\"\r\n            :thumb=\"item.s_goods_photos[0].path\"\r\n            @click=\"checkgoods(item.id)\"\r\n          >\r\n            <template #tags>\r\n              <van-tag plain type=\"danger\">新品</van-tag>\r\n              <van-tag plain type=\"danger\">特价</van-tag>\r\n            </template>\r\n          </van-card>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { get } from '../../Utils/request.js'\r\nimport { toast } from '../../Utils/index.js'\r\nimport { getSession } from '../../Utils/index.js'\r\nimport { useRouter } from 'vue-router';\r\nimport { ref, reactive } from 'vue'\r\nimport { useStore } from 'vuex'\r\nconst store = useStore()\r\nconst router = useRouter();\r\nlet searchVal = ref('')\r\nlet oldlist = ref(getSession('oldSearch'))\r\nlet show = ref(true)\r\nlet flag = ref(false)\r\nlet shopList = ref([])\r\nlet goodslist = ref([])\r\nlet emptyShow = ref(false)\r\n// 获取商品分类\r\nget('/classify/classifyGoods', { project_id: 240 }).then(res => {\r\n  shopList.value = res.result\r\n})\r\nconst goodsGet = (val) => {\r\n  searchVal.value = val\r\n  get('/goodsSearch', { project_id: 240, name: val }).then(res => {\r\n    console.log(res);\r\n    if (!res.result.rows.length) {\r\n      emptyShow.value = true\r\n      get('/goods', { project_id: 240, page: 3, limit: 10 }).then(res => {\r\n        goodslist.value = res.result.rows\r\n      })\r\n    } else {\r\n      emptyShow.value = false\r\n    }\r\n    goodslist.value = res.result.rows\r\n  })\r\n}\r\n\r\n// 确定搜索\r\nconst onSearch = (val) => {\r\n  toast()\r\n  show.value = false\r\n  flag.value = true\r\n  if (val) {\r\n    store.dispatch('search/changoldlist', val)\r\n  }\r\n  goodsGet(val)\r\n}\r\n// 点击搜索\r\nconst search = () => {\r\n  toast()\r\n  show.value = false\r\n  flag.value = true\r\n  if (searchVal.value) {\r\n    store.dispatch('search/changoldlist', searchVal.value)\r\n  }\r\n  goodsGet(searchVal.value)\r\n}\r\n// 点击历史搜索\r\nconst checkoldlist = (data) => {\r\n  toast()\r\n  show.value = false\r\n  flag.value = true\r\n  goodsGet(data)\r\n}\r\n// 删除历史\r\nconst deloldlist = () => {\r\n  toast()\r\n  store.dispatch('search/delList')\r\n  oldlist.value = getSession('oldSearch')\r\n}\r\n\r\n// 点击列表搜索\r\nconst checklist = (id, val) => {\r\n  searchVal.value = val\r\n  toast()\r\n  show.value = false\r\n  flag.value = true\r\n  if (val) {\r\n    store.dispatch('search/changoldlist', val)\r\n  }\r\n  get('/goods', { project_id: 240, page: 1, limit: 10, classify_id: id }).then(res => {\r\n    if (!res.result.rows.length) {\r\n      emptyShow.value = !emptyShow.value\r\n      get('/goods', { project_id: 240, page: 3, limit: 10 }).then(res => {\r\n        goodslist.value = res.result.rows\r\n      })\r\n    }\r\n    goodslist.value = res.result.rows\r\n  })\r\n  //   goodsGet(val)\r\n}\r\n\r\n// 取消\r\nconst onCancel = () => {\r\n  toast()\r\n  store.commit(\"changeRouterType\", \"back\")\r\n  history.back()\r\n}\r\n// 点击进入商品详情\r\nconst checkgoods = (id) => {\r\n  store.commit(\"changeRouterType\", \"push\")\r\n  router.push(`shoppage?key=${id}`)\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.body {\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: #f6f6f6;\r\n  .page {\r\n    margin-top: 0.53rem;\r\n    padding-left: 0.16rem;\r\n    padding-right: 0.16rem;\r\n    min-height: calc(100vh - 0.54rem);\r\n    .top {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      width: 100%;\r\n      z-index: 999;\r\n      background-color: #fff;\r\n\r\n      .left {\r\n        margin-left: 000.12rem;\r\n      }\r\n      .input {\r\n        width: 90%;\r\n      }\r\n      .right {\r\n        margin-right: 00.16rem;\r\n        width: 0.4rem;\r\n        height: 0.3rem;\r\n        color: #fff;\r\n        background-color: #e93b3d;\r\n        border-radius: 00.05rem;\r\n        text-align: center;\r\n        line-height: 00.3rem;\r\n      }\r\n    }\r\n    .search {\r\n      margin-top: 00.54rem;\r\n      padding-top: 00.26rem;\r\n      padding-left: 00.16rem;\r\n      padding-right: 00.16rem;\r\n      .title {\r\n        display: flex;\r\n        justify-content: space-between;\r\n      }\r\n      h2 {\r\n        font-size: 00.16rem;\r\n        color: #333;\r\n      }\r\n      button {\r\n        margin-top: 00.15rem;\r\n        margin-left: 00.15rem;\r\n      }\r\n    }\r\n    .empty {\r\n      h3 {\r\n        padding-left: 00.16rem;\r\n        font-size: 0.18rem;\r\n        color: #333;\r\n      }\r\n    }\r\n    .goodslist {\r\n      padding-bottom: 00.5rem;\r\n    }\r\n  }\r\n}\r\n.van-icon {\r\n  font-size: 00.2rem;\r\n}\r\n</style>","import script from \"./Searchpage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Searchpage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Searchpage.vue?vue&type=style&index=0&id=1a74cf71&lang=scss&scoped=true\"\n\nimport exportComponent from \"F:\\\\My-project\\\\shop\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1a74cf71\"]])\n\nexport default __exports__"],"names":["store","useStore","router","useRouter","searchVal","ref","oldlist","getSession","show","flag","shopList","goodslist","emptyShow","get","project_id","then","res","value","result","goodsGet","val","name","console","log","rows","length","page","limit","onSearch","toast","dispatch","search","checkoldlist","data","deloldlist","checklist","id","classify_id","onCancel","commit","history","back","checkgoods","push","__exports__"],"sourceRoot":""}