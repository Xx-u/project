{"version":3,"file":"js/260.5461db55.js","mappings":"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","sources":["webpack://demo/./src/views/order/orderPage.vue","webpack://demo/./src/views/order/orderPage.vue?befd"],"sourcesContent":["<template>\r\n  <div class=\"body\">\r\n    <div class=\"orderpage\">\r\n      <div class=\"top\">\r\n        <van-nav-bar\r\n          title=\"确认订单\"\r\n          left-text=\"\"\r\n          left-arrow\r\n          @click-left=\"onClickLeft\"\r\n        />\r\n      </div>\r\n\r\n      <div class=\"address\">\r\n        <div class=\"edit\">\r\n          <h3>收货地址</h3>\r\n\r\n          <p>\r\n            {{ site.address }}\r\n            <van-badge class=\"badge\" :content=\"title\" />\r\n          </p>\r\n          <p>\r\n            {{ site.name }} <span>{{ site.tel }}</span>\r\n          </p>\r\n        </div>\r\n        <van-icon class=\"edit-icon\" name=\"edit\" @click=\"onEdit\" />\r\n      </div>\r\n\r\n      <div class=\"actionsheet\">\r\n        <van-action-sheet v-model:show=\"show\" title=\"选择收货地址\">\r\n          <div class=\"content\">\r\n            <van-address-list\r\n              v-model=\"value\"\r\n              :list=\"list\"\r\n              default-tag-text=\"默认\"\r\n              @select=\"optSelect\"\r\n              switchable\r\n              @add=\"onAdd\"\r\n              @edit=\"goToEdit\"\r\n            />\r\n          </div>\r\n        </van-action-sheet>\r\n      </div>\r\n\r\n      <div class=\"order\">\r\n        <div class=\"goods\" v-for=\"item in shopList\" :key=\"item.id\">\r\n          <van-swipe-cell>\r\n            <van-card\r\n              :num=\"item.num\"\r\n              :price=\"item.s_good.price\"\r\n              :desc=\"item.s_good.desc\"\r\n              :title=\"item.s_good.name\"\r\n              class=\"goods-card\"\r\n              :thumb=\"item.s_good.s_goods_photos[0].path\"\r\n            />\r\n          </van-swipe-cell>\r\n        </div>\r\n        <div class=\"count\">\r\n          <van-swipe-cell>\r\n            <van-cell\r\n              :border=\"false\"\r\n              title=\"配送服务\"\r\n              value=\"快递 包邮\"\r\n              is-link\r\n            />\r\n            <van-cell :border=\"false\" title=\"运费险\" value=\"未选择\" is-link />\r\n            <van-cell :border=\"false\" title=\"订单备注\" value=\"无备注\" is-link />\r\n          </van-swipe-cell>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"money\">\r\n        <div class=\"goodsMoney\">\r\n          <van-cell value=\"价格明细\" />\r\n          <van-cell title=\"商品总数\" :value=\"shopNum\" />\r\n        </div>\r\n        <div class=\"center\">\r\n          <van-coupon-cell\r\n            :coupons=\"coupons\"\r\n            :chosen-coupon=\"chosenCoupon\"\r\n            @click=\"showList = true\"\r\n          />\r\n          <van-popup\r\n            :show=\"showList\"\r\n            round\r\n            position=\"bottom\"\r\n            style=\"height: 90%; padding-top: 4px\"\r\n          >\r\n            <van-coupon-list\r\n              :coupons=\"coupons\"\r\n              :chosen-coupon=\"chosenCoupon\"\r\n              :disabled-coupons=\"disabledCoupons\"\r\n              @change=\"onChange\"\r\n              @exchange=\"onExchange\"\r\n            />\r\n          </van-popup>\r\n        </div>\r\n        <div class=\"all\">\r\n          <van-cell title=\"合计\" :value=\"'￥' + price / 100\" />\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"submit\">\r\n        <van-submit-bar\r\n          :price=\"price\"\r\n          button-text=\"提交订单\"\r\n          @submit=\"onSubmit\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { Dialog } from 'vant';\r\nimport { toast } from '../../Utils/index.js'\r\nimport { get, post } from '../../Utils/request.js'\r\nimport { ref, computed } from 'vue'\r\nimport { useStore } from 'vuex';\r\nimport { useRoute, useRouter } from 'vue-router'\r\nlet route = useRoute()\r\nlet router = useRouter()\r\nlet store = useStore()\r\nlet list = ref([])\r\nlet site = ref([])\r\nlet title = ref(null)\r\nlet show = ref(false)\r\nlet value = ref('')\r\n\r\nlet shopList = ref(store.state.shoporder.cradList)\r\n\r\nconst change = (name) => {\r\n  store.state.shoporder.orderpageChecked = name\r\n}\r\n\r\n// get请求\r\ngetEdit()\r\nasync function getEdit () {\r\n  list.value = []\r\n  let res = await get('/address')\r\n  res.result.forEach(ele => {\r\n    let obj = {\r\n      id: ele.id,\r\n      name: ele.name,\r\n      tel: ele.phone,\r\n      address: ele.area_name + '  ' + ele.desc,\r\n      isDefault: ele.default_set === '1' ? true : false,\r\n    }\r\n    list.value.push(obj)\r\n  });\r\n  site.value = list.value.find(ele => ele.isDefault)\r\n  value.value = site.value.id\r\n  title.value = '默认'\r\n}\r\n// 切换选中地址\r\nconst optSelect = (val) => {\r\n  site.value = val\r\n  show.value = false\r\n  if (site.value.isDefault) {\r\n    title.value = '默认'\r\n  } else {\r\n    title.value = ''\r\n  }\r\n}\r\n\r\n\r\n// 编辑地址\r\nconst onEdit = () => {\r\n  show.value = true\r\n}\r\n// 新建\r\nconst onAdd = () => {\r\n  toast()\r\n  store.commit(\"changeRouterType\", \"push\")\r\n  router.push('/newedit')\r\n};\r\n// 编辑\r\nconst goToEdit = (item) => {\r\n  toast()\r\n  store.commit(\"changeRouterType\", \"push\")\r\n  router.push(`/edit?key=${item.id}`)\r\n};\r\n\r\n// 总价\r\nconst price = computed(() => {\r\n  let money = 0\r\n  shopList.value.forEach(ele => {\r\n    money += ele.s_good.price * ele.num * 100\r\n  })\r\n  return money\r\n})\r\n// 总数\r\nconst shopNum = computed(() => {\r\n  let num = 0\r\n  shopList.value.forEach(ele => {\r\n    num += ele.num\r\n  })\r\n  return num\r\n})\r\n// 优惠券\r\nconst coupon = {\r\n  available: 1,\r\n  condition: '无门槛\\n最多优惠12元',\r\n  reason: '',\r\n  value: 150,\r\n  name: '优惠券名称',\r\n  startAt: 1489104000,\r\n  endAt: 1514592000,\r\n  valueDesc: '1.5',\r\n  unitDesc: '元',\r\n};\r\n\r\nconst coupons = ref([coupon]);\r\nconst showList = ref(false);\r\nconst chosenCoupon = ref(-1);\r\n\r\nconst onChange = (index) => {\r\n  showList.value = false;\r\n  chosenCoupon.value = index;\r\n};\r\nconst onExchange = (code) => {\r\n  coupons.value.push(coupon);\r\n};\r\n\r\n\r\n// 返回\r\nconst onClickLeft = () => {\r\n  Dialog.confirm({\r\n    title: '小xu提示',\r\n    message:\r\n      '您是否确认取消订单?',\r\n  })\r\n    .then(() => {\r\n      store.commit(\"changeRouterType\", \"back\")\r\n      router.push('/shopping')\r\n    }).catch(() => { });\r\n}\r\n\r\n// 提交订单\r\nconst onSubmit = async () => {\r\n  toast()\r\n  let shopArr = store.state.shoporder.cradList\r\n  let addressArr = site.value\r\n  let shopId = []\r\n  let goodsInfo = []\r\n  shopArr.forEach(ele => {\r\n    let goodsObj = { id: ele.goods_id, num: ele.num }\r\n    goodsInfo.push(goodsObj)\r\n    shopId.push(ele.goods_id)\r\n  })\r\n  let body = {\r\n    addr_id: addressArr.id,\r\n    goods_info: goodsInfo,\r\n    project_id: 240,\r\n    shoppingCartIds: shopId\r\n  }\r\n  post('/order', body).then(res => {\r\n    let id = res.data.result.id\r\n    store.commit(\"changeRouterType\", \"push\")\r\n    router.push(`/paymentOrder?key=${id}`)\r\n  })\r\n}\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.body {\r\n  width: 100%;\r\n  min-height: 100%;\r\n  background-color: #f6f6f6;\r\n}\r\n.orderpage {\r\n  padding: 0.16rem;\r\n  margin-bottom: 000.5rem;\r\n  margin-top: 0.46rem;\r\n  min-height: calc(100vh - 1.3rem);\r\n}\r\n.top {\r\n  width: 100%;\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  z-index: 99;\r\n}\r\n.van-cell {\r\n  margin-top: 00.08rem;\r\n  border-radius: 00.15rem;\r\n  background-color: #fff;\r\n}\r\n.address {\r\n  position: relative;\r\n  width: 100%;\r\n  border-radius: 00.15rem;\r\n  background-color: #fff;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 0.16rem;\r\n  box-sizing: border-box;\r\n  box-shadow: rgb(0 0 0 / 25%) 0rem 0.05rem 0.15rem;\r\n  .edit {\r\n    h3 {\r\n      font-size: 0.16rem;\r\n      color: #333;\r\n      margin-bottom: 0.14rem;\r\n    }\r\n    p {\r\n      font-size: 0.14rem;\r\n      color: #333;\r\n      &:last-child {\r\n        font-size: 0.12rem;\r\n        color: #666;\r\n        margin-top: 0.06rem;\r\n      }\r\n    }\r\n  }\r\n  .badge {\r\n    .van-badge {\r\n      width: 0.5rem;\r\n    }\r\n  }\r\n  .edit-icon {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: #666;\r\n    font-size: 0.25rem;\r\n  }\r\n}\r\n.actionsheet {\r\n  .content {\r\n    padding: 16px 16px 160px;\r\n    .van-address-list {\r\n      padding: 0 !important;\r\n    }\r\n  }\r\n}\r\n.order {\r\n  width: 100%;\r\n  margin-top: 00.2rem;\r\n  border-radius: 00.15rem;\r\n  background-color: #fff;\r\n  box-shadow: rgb(0 0 0 / 25%) 0rem 0.05rem 0.15rem;\r\n\r\n  .goods {\r\n    padding-top: 00.15rem;\r\n    .goods-card {\r\n      margin: 0;\r\n      border-radius: 00.2rem;\r\n      background-color: #fff !important;\r\n    }\r\n\r\n    .delete-button {\r\n      height: 100%;\r\n    }\r\n    .add {\r\n      position: absolute;\r\n      right: 0.13rem;\r\n      bottom: 0.07rem;\r\n    }\r\n  }\r\n}\r\n.money {\r\n  width: 100%;\r\n  margin-top: 00.2rem;\r\n  border-radius: 00.15rem;\r\n  background-color: #fff;\r\n  box-shadow: rgb(0 0 0 / 25%) 0rem 0.05rem 0.15rem;\r\n}\r\n</style>","import script from \"./orderPage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./orderPage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./orderPage.vue?vue&type=style&index=0&id=257ec971&lang=scss&scoped=true\"\n\nimport exportComponent from \"F:\\\\My-project\\\\shop\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-257ec971\"]])\n\nexport default __exports__"],"names":["useRoute","router","useRouter","store","useStore","list","ref","site","title","show","value","shopList","state","shoporder","cradList","async","getEdit","res","get","result","forEach","ele","obj","id","name","tel","phone","address","area_name","desc","isDefault","default_set","push","find","optSelect","val","onEdit","onAdd","toast","commit","goToEdit","item","price","computed","money","s_good","num","shopNum","coupon","available","condition","reason","startAt","endAt","valueDesc","unitDesc","coupons","showList","chosenCoupon","onChange","index","onExchange","code","onClickLeft","Dialog","message","then","catch","onSubmit","shopArr","addressArr","shopId","goodsInfo","goodsObj","goods_id","body","addr_id","goods_info","project_id","shoppingCartIds","post","data","__exports__"],"sourceRoot":""}